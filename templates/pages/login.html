{% extends 'base.html' %}
{% load static %}
{% block title %}Login - DailyVotion{% endblock %}
{% block hide_navbar %}navbar-hidden{% endblock %}
{% block head_css %}
<link rel="stylesheet" href="{% static 'css/User/UserLogin.css' %}">
{% endblock %}
{% block corner_menu %}
<!-- Corner menu button for auth pages -->
<button id="auth-menu-button" class="homepage-menu-button" aria-label="Menu">
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M3 18H21V16H3V18ZM3 13H21V11H3V13ZM3 6V8H21V6H3Z" fill="white"/>
  </svg>
</button>
{% endblock %}
{% block content %}
<div class="loginpage-container">
  <div class="loginpage-main">
  <div class="loginpage-paper" style="box-shadow:0 4px 24px 0 rgba(0,0,0,0.18), 0 1.5px 6px 0 rgba(0,0,0,0.10);">
      <h2 class="loginpage-title">Login to DailyVotion</h2>
      <form method="post">
        {% csrf_token %}
        {# Show only auth-related messages to avoid leaks from other pages #}
        {% if messages %}
          {% with auth_msgs=messages|dictsort:"tags" %}
            <ul class="form-messages">
              {% for m in messages %}
                {% if not m.tags or 'auth' in m.tags or 'login' in m.tags %}
                  <li>{{ m }}</li>
                {% endif %}
              {% endfor %}
            </ul>
          {% endwith %}
        {% endif %}
        <input type="text" name="identifier" placeholder="Email or Username" required />
        <div class="loginpage-password-field">
          <input type="password" name="password" placeholder="Password" id="pwd" required />
          <span class="loginpage-eye" id="pwd-eye" role="button">ğŸ‘ï¸â€ğŸ—¨ï¸</span>
        </div>
        <div class="loginpage-options">
          <label><input type="checkbox" /> Remember me</label>
          <button type="button" class="loginpage-forgot">Forgot password?</button>
        </div>
  <button type="submit" class="loginpage-loginbtn btn-softpulse">Login</button>
      </form>
      <div class="loginpage-divider"></div>
      <div class="loginpage-register">
        <span>New to DailyVotion?</span>
  <a class="loginpage-createbtn btn-softpulse" href="{% url 'register' %}">Create Account</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}
{% block extra_js %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Corner menu setup
    const menuButton = document.getElementById('auth-menu-button');
    
    if (menuButton) {
      // Create a dropdown menu
      const menu = document.createElement('div');
      menu.className = 'auth-dropdown-menu';
      menu.style.position = 'fixed';
      menu.style.top = '80px';
      menu.style.right = '20px';
      menu.style.backgroundColor = '#008b8b';
      menu.style.borderRadius = '8px';
      menu.style.padding = '10px 0';
      menu.style.boxShadow = '0 2px 10px rgba(0, 0, 0, 0.2)';
      menu.style.zIndex = '1100';
      menu.style.display = 'none';
      
      // Create menu items
      const menuItems = [
        { text: 'Home', url: '{% url "home" %}' },
        { text: 'Login', url: '{% url "login" %}' },
        { text: 'Register', url: '{% url "register" %}' },
        { text: 'Admin', url: '{% url "admin_login" %}' },
        { text: 'About', url: '{% url "about" %}' }
      ];
      
      const menuList = document.createElement('ul');
      menuList.style.listStyle = 'none';
      menuList.style.margin = '0';
      menuList.style.padding = '0';
      
      menuItems.forEach(item => {
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = item.url;
        a.textContent = item.text;
        a.style.color = 'white';
        a.style.textDecoration = 'none';
        a.style.padding = '10px 20px';
        a.style.display = 'block';
        a.style.fontWeight = 'bold';
        a.style.whiteSpace = 'nowrap';
        
        a.addEventListener('mouseover', function() {
          this.style.backgroundColor = 'rgba(255, 255, 255, 0.1)';
        });
        
        a.addEventListener('mouseout', function() {
          this.style.backgroundColor = 'transparent';
        });
        
        li.appendChild(a);
        menuList.appendChild(li);
      });
      
      menu.appendChild(menuList);
      document.body.appendChild(menu);
      
      // Toggle menu visibility
      menuButton.addEventListener('click', function() {
        if (menu.style.display === 'none') {
          menu.style.display = 'block';
        } else {
          menu.style.display = 'none';
        }
      });
      
      // Close menu when clicking outside
      document.addEventListener('click', function(e) {
        if (e.target !== menuButton && !menuButton.contains(e.target) && !menu.contains(e.target)) {
          menu.style.display = 'none';
        }
      });
    }

    // Existing login functionality
    // Dropdown
    const lbtn = document.getElementById('login-menu-btn');
    const lmenu = document.getElementById('login-menu');
    if (lbtn && lmenu) {
      lmenu.classList.add('hidden');
      lbtn.setAttribute('aria-expanded', 'false');
      const toggle = (e) => {
        e.stopPropagation();
        const nowHidden = lmenu.classList.toggle('hidden');
        lbtn.setAttribute('aria-expanded', (!nowHidden).toString());
      };
      lbtn.addEventListener('click', toggle);
      document.addEventListener('click', (e) => {
        if (!lmenu.classList.contains('hidden') && !lmenu.contains(e.target) && !lbtn.contains(e.target)) {
          lmenu.classList.add('hidden');
          lbtn.setAttribute('aria-expanded', 'false');
        }
      });
    }
    // Eye toggle
    const eye = document.getElementById('pwd-eye');
    const pwd = document.getElementById('pwd');
    if (eye && pwd) {
      eye.addEventListener('click', ()=>{
        if (pwd.type === 'password') { pwd.type = 'text'; eye.textContent = 'ğŸ‘ï¸'; }
        else { pwd.type = 'password'; eye.textContent = 'ğŸ‘ï¸â€ğŸ—¨ï¸'; }
      });
    }
  });
</script>
{% endblock %}
